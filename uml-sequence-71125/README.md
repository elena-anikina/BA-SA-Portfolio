Диаграмма последовательности: Авторизация пользователя по JWT токену
Назначение диаграммы
Диаграмма описывает процесс аутентификации и авторизации пользователя в системе с использованием JWT (JSON Web Token) токенов, включая как успешный сценарий, так и обработку ошибок.

Участники системы
Участник	Роль и ответственность
User (Пользователь)	Инициатор процесса, предоставляет учетные данные
UI Frontend	Клиентский интерфейс, валидация ввода, управление сессией
Service Proxy	Маршрутизация запросов, промежуточный слой
Service Backend	Бизнес-логика, генерация токенов, проверка прав
DB (База данных)	Хранение пользовательских данных, логирование
Основной сценарий (успешная авторизация)
Фаза 1: Первичная аутентификация
User → UI Frontend: Нажатие кнопки "Войти"

UI Frontend: Проведение валидации введенных данных

UI Frontend → Service Proxy: POST /login {login, password}

Service Proxy → Service Backend: POST /login {login, password}

Фаза 2: Проверка учетных данных
Service Backend → DB: SQL-запрос (авторизация и аутентификация)

DB → Service Backend: Ответ (id пользователя, права доступа)

Service Backend: Генерация JWT токена

Service Backend → DB: SQL запрос для логирования операции

Фаза 3: Возврат токена
Service Backend → Service Proxy: JWT токен

Service Proxy → UI Frontend: JWT токен

Фаза 4: Доступ к защищенным ресурсам
UI Frontend → Service Proxy: GET /something с заголовком Authorization: JWT...

Service Proxy → Service Backend: GET /something с заголовком Authorization: JWT...

Фаза 5: Верификация токена и обработка запроса
Service Backend: Проверка подписи JWT токена

Service Backend: Получение данных из JWT токена

Service Backend → DB: SQL-запрос на поиск данных

DB → Service Backend: Данные

Service Backend: Проверка данных

Фаза 6: Успешный ответ
Service Backend → Service Proxy: Успешный статус 200 OK + JWT токен + Данные

Service Proxy → UI Frontend: Успешный статус 200 OK + JWT токен + Данные

UI Frontend → User: Вывод данных пользователю

Альтернативный сценарий (невалидный токен)
При невалидном токене:
Service Backend → Service Proxy: Ошибка 401 Unauthorized

Service Proxy → UI Frontend: Ошибка 401 Unauthorized

UI Frontend → User: Сообщение об ошибке аутентификации

Ключевые особенности системы
Безопасность
JWT токены для stateless аутентификации

Проверка подписи токена на стороне backend

Автоматическое обновление токена при успешных запросах

HTTP-коды ошибок для различных сценариев

Архитектурные решения
Service Proxy для централизованной маршрутизации

Разделение ответственности между компонентами

Логирование операций аутентификации

Валидация на клиенте и сервере

Потоки данных
Учетные данные передаются только при первоначальной аутентификации

JWT токен используется для последующих запросов

Данные пользователя извлекаются на основе информации в токене

Преимущества подхода
Масштабируемость: Stateless архитектура

Безопасность: Токены вместо сессий

Производительность: Минимальные запросы к БД после аутентификации

Универсальность: Единый механизм для разных клиентов


